---
import InternalPageLayout from '@/layouts/shared/InternalPageLayout.astro'
import ServicesList from '@/components/shared/ServicesList.astro'
import { fetchServicesPageByLocale } from '@/lib/sanity/queries/servicesPageQueries'
import type { ServicesPage } from '@/lib/sanity/schemas/servicesPageSchema'
import { getPageMetadata } from '@/config/i18n/pageMetadata'

const { locale } = Astro.props

let servicesPageData: ServicesPage | null = null

try {
  servicesPageData = await fetchServicesPageByLocale(locale)
} catch (error) {
  console.error('Error fetching services page data:', error)
}

const metadata = getPageMetadata('services', locale)
---

<InternalPageLayout
  pageMetaTitle={metadata.title}
  pageMetaDescription={metadata.description}
  pageTitle={servicesPageData?.title || 'Serveis'}
>
  <ServicesList services={servicesPageData?.selectedServices} class="g-negative-inline-padding" />
</InternalPageLayout>
