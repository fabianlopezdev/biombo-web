---
import BaseLayout from '@/layouts/BaseLayout.astro'
import Header from '@/components/shared/header/Header.astro'
import Footer from '@/components/shared/Footer.astro'
import type { HomePage } from '@/shared/schemas/sanity/homePageSchema'
import Projects, {
  type ResolvedProjectsSectionData,
} from '@/components/pages/homepage/Projects.astro'
import ProjectsMobile from '@/components/pages/homepage/ProjectsMobile.astro'
import Hero from '@/components/pages/homepage/Hero.astro'
import About from '@/components/pages/homepage/about-section/About.astro'
import Services from '@/components/pages/homepage/services-section/Services.astro'

// About component fetches its own data based on locale

interface Props {
  locale: 'ca' | 'es' | 'en'
  homePageData: HomePage | null
}

const { locale } = Astro.props
const { homePageData } = Astro.props

const pageTitle = 'Biombo - Art, Events, Community'
---

<script src="@/scripts/pages/homepage/horizontalScroll.ts"></script>
<script>
  import { initTouchDetection } from '@/utils/touchDetection'
  
  // Initialize touch detection on page load
  document.addEventListener('DOMContentLoaded', () => {
    initTouchDetection()
  })
</script>

<BaseLayout title={pageTitle}>
  <Header locale={locale} />

  <main id="main" class="main-content">
    <!-- Desktop layout with horizontal scroll -->
    <div class="horizontal-scroll-container just-no-touch" id="horizontal-container">
      <section class="hero">
        <Hero locale={locale} heroData={homePageData?.hero} />
      </section>

      <section id="projects" class="projects">
        <Projects
          projectsData={homePageData?.projects as ResolvedProjectsSectionData}
          locale={locale}
        />
      </section>
    </div>

    <!-- Mobile/Touch layout with vertical scroll -->
    <div class="vertical-scroll-container just-touch">
      <section class="hero">
        <Hero locale={locale} heroData={homePageData?.hero} />
      </section>

      <section id="projects-mobile" class="projects-mobile">
        <ProjectsMobile
          projectsData={homePageData?.projects as ResolvedProjectsSectionData}
          locale={locale}
        />
      </section>
    </div>

    <!-- <About sectionData={homePageData?.about} /> -->
    <!-- <Services servicesData={homePageData?.services} /> -->
  </main>

  <!-- <Footer /> -->
</BaseLayout>

<style>
  .horizontal-scroll-container {
    block-size: calc(100vh - var(--header-height));
    display: flex;
    overflow-x: auto;
    overscroll-behavior-x: contain;
    -webkit-overflow-scrolling: touch;
    /* scroll-snap-type: x proximity; */
  }

  .horizontal-scroll-container > section {
    flex: 0 0 100vw;
    block-size: inherit;
    /* scroll-snap-align: start; */
  }

  .hero {
    padding-inline: var(--padding-inline);
    display: flex;
    align-items: center;
    position: relative;
  }

  .projects {
    flex: 0 0 183.3vw !important;
  }

  .vertical-scroll-container {
    display: flex;
    flex-direction: column;
    min-height: calc(100vh - var(--header-height));
  }

  .vertical-scroll-container .hero {
    height: calc(100vh - var(--header-height));
    padding-inline: var(--padding-inline);
    display: flex;
    align-items: center;
    position: relative;
  }

  .projects-mobile {
    width: 100%;
  }

  @media (width < 768px) {
    .horizontal-scroll-container {
      block-size: auto;
    }
  }
</style>
