---
import ProjectsLayout from '@/layouts/pages/ProjectsLayout.astro'
import { fetchProjectsByLocale } from '@/lib/sanity/queries/projectQueries'
import { fetchServicesByLocale } from '@/lib/sanity/queries/serviceQueries'
import { fetchProjectsPageByLocale } from '@/lib/sanity/queries/projectsPageQueries'
import type { Locale } from '@/config/i18n/projects'

interface Props {
  locale: Locale
}

const { locale } = Astro.props

console.log('üåê [Projects Page Wrapper] Locale:', locale)

// Fetch all projects, services, and page data for the given locale
let projects = null
let services = null
let projectsPageData = null

try {
  projects = await fetchProjectsByLocale(locale)
  services = await fetchServicesByLocale(locale)
  projectsPageData = await fetchProjectsPageByLocale(locale)
  console.log('üìÑ [Projects Page Wrapper] Projects Page Data:', projectsPageData)
  console.log('üìÑ [Projects Page Wrapper] Page Title:', projectsPageData?.title)
} catch (error) {
  console.error(`‚ùå [Projects Page Wrapper] Error fetching data for locale ${locale}:`, error)
}
---

<ProjectsLayout {locale} {projects} {services} {projectsPageData} />
